A1=[1.46308728618423 -0.659259340517936 0.470308786909565 -0.319509449284540 -0.143633984130752 0.110649948956651 -0.0718401559309970 0.0766038659806126 -0.0213593105299636;1 0 0 0 0 0 0 0 0;0 1 0 0 0 0 0 0 0;0 0 1 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0;0 0 0 0 1 0 0 0 0;0 0 0 0 0 1 0 0 0;0 0 0 0 0 0 1 0 0;0 0 0 0 0 0 0 1 0];
B1=[1;0;0;0;0;0;0;0;0];
C1=[-0.00477256053053636 -0.00294060913792497 0.0151248534351877 0.0102593618668330 0.0413370759531112 0.0170926813556174 0.00375695765545254 0.0385995195147232 0];
D1=0;
Ts=0.05;
% -4 + 4.0012 i
% -4 - 4.0012 i
% -8
s1=-4+4.0012*j; s2=-4 -4.0012*j; s3=-14;
s4=-25; s5=-26; s6=-27; s7=-28; s8=-29;
s9=-30;

z1=exp(s1*Ts); z2=exp(s2*Ts); z3=exp(s3*Ts);
z4=exp(s4*Ts); z5=exp(s5*Ts); z6=exp(s6*Ts);
z7=exp(s7*Ts); z8=exp(s8*Ts); z9=exp(s9*Ts);
F=blkdiag([0.6225 0.1379; -0.1379 0.6225], z3, z4, z5, z6, z7, z8, z9);
kb=[1 0 1 1 1 1 1 1 1 ];
rank(obsv(F,kb))

 t1=lyap(A1,-F, -B1*kb);
 k1=kb*inv(t);
 eig(A1-B1*k)

Garx=ss(A1-B1*k,B1,C1,D1,Ts);
% step(Garx)
z1=exp(s1*Ts); z2=exp(s2*Ts); z3=exp(s3*Ts);
z4=exp(s4*Ts); z5=exp(s5*Ts); z6=exp(s6*Ts);
z7=exp(s7*Ts); z8=exp(s8*Ts); z9=exp(s9*Ts);
F2=blkdiag([0.6225 0.1379; -0.1379 0.6225], z3, z4, z5, z6, z7, z8, z9);
kb=[1 1 1 1 1 1 1 1 1];

lb=[1 1 1];
rank(ctrb(F2,lb'));

t2=lyap(F2,-A1,lb'*C1);
l1=inv(t2)*lb';
eig(A1-l*C1)
